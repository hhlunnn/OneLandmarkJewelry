<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>飾品網站</title>
    <link rel="stylesheet" href="../assets/CSS/item_style.css">
    <script src="https://code.iconify.design/iconify-icon/2.1.0/iconify-icon.min.js"></script>
</head>
<body>
    <header>
        <div class="logo-container">
          <a href="../index.html"><img src="../assets/image/img/logo.png" alt="網站Logo"></a>
        </div>
      </header>
      
    
      <nav>
        <ul class="navbar-nav mb-2 mb-md-0 px-4">
          <li class="nav-item mx-lg-3 pt-lg-5 dropdown">
            <a class="nav-link" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              會員中心
            </a>
            <ul class="dropdown-menu text-center">
              <li><a class="dropdown-item" href="../pages/login.html">登入註冊</a></li>
              <li><a class="dropdown-item" href="../pages/member.html">會員中心</a></li>
            </ul>
          <li class="nav-item mx-lg-3 pt-lg-5 dropdown">
            <a class="nav-link" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              耳環
            </a>
            <ul class="dropdown-menu text-center">
              <li><a class="dropdown-item" href="../pages/item1.html">玫瑰金心珍珠耳環</a></li>
              <li><a class="dropdown-item" href="../pages/item2.html">玫瑰金幾何耳環</a></li>
              <li><a class="dropdown-item" href="../pages/item3.html">雙色金屬耳環</a></li>
            </ul>
          </li>
          <li class="nav-item mx-lg-3 pt-lg-5 dropdown">
            <a class="nav-link" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              項鍊
            </a>
            <ul class="dropdown-menu text-center">
              <li><a class="dropdown-item" href="../pages/item4.html">雙心鑽玫瑰金項鍊</a></li>
              <li><a class="dropdown-item" href="../pages/item5.html">紫色花瓣造型項鍊</a></li>
              <li><a class="dropdown-item" href="../pages/item6.html">圓形水鑽花瓣項鍊</a></li>
            </ul>
          </li>
          <li class="nav-item mx-lg-3 pt-lg-5 dropdown">
            <a class="nav-link" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              手鍊
            </a>
            <ul class="dropdown-menu text-center">
              <li><a class="dropdown-item" href="../pages/item7.html">玫瑰光鑽手鍊</a></li>
              <li><a class="dropdown-item" href="../pages/item8.html">冷光晶鑽手鍊</a></li>
              <li><a class="dropdown-item" href="../pages/item9.html">月光交錯手鍊</a></li>
            </ul>
          </li>
          <li class="nav-item mx-lg-3 pt-lg-5 dropdown">
            <a class="nav-link" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              戒指
            </a>
            <ul class="dropdown-menu text-center">
              <li><a class="dropdown-item" href="../pages/item10.html">玫瑰金交錯戒</a></li>
              <li><a class="dropdown-item" href="../pages/item11.html">白金編織戒</a></li>
              <li><a class="dropdown-item" href="../pages/item12.html">扭結造型戒</a></li>
            </ul>
          </li>

          <li class="nav-item mx-lg-3 pt-lg-5">
            <a class="nav-link d-flex align-items-center" aria-current="page" href="../pages/cart.html">購物車</a>
          </li>
    
          <li class="nav-item mx-lg-3 pt-lg-5">
            <a class="nav-link active" aria-current="page" href="../pages/problem.html">常見問題</a>
          </li>
        </ul>
     </nav>

    <article>
        <section class="card">
            <div class="flex1">
                <div class="picture">
                    <img class="item_image1" src="../assets/image/img/earrings1.jpg" alt="Carnation">
                </div>
                <div class="flex2">
                    <div class="text">
                        <h3>品名: 愛戀珍珠心（玫瑰金心型珍珠耳環）</h3>
                    </div>
                    <div class="text2">
                        <p>*設計特色：</p>
                        <p>玫瑰金心型結構搭配天然感珍珠，溫柔優雅</p>
                        <p>上方鑲有閃鑽點綴，提升整體華麗感</p>
                        <p>呈現出浪漫、柔美又細緻的愛情象徵</p>
                        <br>
                        <p>*適合對象：情人節禮物、母親節、約會配戴</p>
                        <p>*風格推薦：溫柔甜美、氣質款式</p>
                        <p class="price-stock">售價：NT$ 280／庫存：50</p>

                        <div class="quantity-wrapper">
                          <button type="button" id="decreaseQty">－</button>
                          <input type="number" id="quantityInput" value="1" min="1" />
                          <button type="button" id="increaseQty">＋</button>
                        </div>
                        
                        <button class="add-cart-btn" id="addToCartBtn">加入購物車</button>
                    </div>
                </div>
            </div>
            
        </section>

        <section class="reviews" id="commentsContainer">
          
        </section>
        
        <!-- 新增評論部分 -->
        <section class="reviews">
            <h2>評論:</h2>
            <div class="review">
                <div class="review-header">
                    <span class="review-author">留言者: 小芸</span>
                    <span class="review-date">日期: 2025-05-20</span>
                    <div class="star">
                        <iconify-icon icon="mdi:star" width="40"></iconify-icon>
                        <iconify-icon icon="mdi:star" width="40"></iconify-icon>
                        <iconify-icon icon="mdi:star" width="40"></iconify-icon>
                        <iconify-icon icon="mdi:star" width="40"></iconify-icon>
                        <iconify-icon icon="mdi:star" width="40"></iconify-icon>
                    </div>
                </div>
                <p class="review-text">戴起來超有氣質，耳環非常精緻，值得收藏！</p>
            </div>
            
            <div class="review">
                <div class="review-header">
                    <span class="review-author">留言者: 阿宏</span>
                    <span class="review-date">日期: 2025-05-21</span>
                    <div class="star">
                        <iconify-icon icon="mdi:star" width="40"></iconify-icon>
                        <iconify-icon icon="mdi:star" width="40"></iconify-icon>
                        <iconify-icon icon="mdi:star" width="40"></iconify-icon>
                        <iconify-icon icon="mdi:star-outline" width="40"></iconify-icon>
                        <iconify-icon icon="mdi:star-outline" width="40"></iconify-icon>
                    </div>
                </div>
                <p class="review-text">造型不錯，但戴久耳朵會有點痛。</p>
            </div>
            <div id="dynamicComments"></div>
        </section>

            <!-- 新增留言表單 -->
            <div class="card2">
              <form id="comment-form" class="comment-form">
                <label for="comment-name">姓名：</label><br>
                <input type="text" id="comment-name" name="comment-name" /><br>

                <label for="comment-content">評論：</label><br>
                <textarea id="comment-content" name="comment-content" rows="4" cols="70"></textarea><br>

                <label for="comment-rating">星等：</label><br>
                <div class="star-rating" id="comment-rating">
                  <iconify-icon icon="mdi:star-outline" width="40" data-index="1" class="star-icon" onclick="setRating(1)"></iconify-icon>
                  <iconify-icon icon="mdi:star-outline" width="40" data-index="2" class="star-icon" onclick="setRating(2)"></iconify-icon>
                  <iconify-icon icon="mdi:star-outline" width="40" data-index="3" class="star-icon" onclick="setRating(3)"></iconify-icon>
                  <iconify-icon icon="mdi:star-outline" width="40" data-index="4" class="star-icon" onclick="setRating(4)"></iconify-icon>
                  <iconify-icon icon="mdi:star-outline" width="40" data-index="5" class="star-icon" onclick="setRating(5)"></iconify-icon>
                </div><br>

                <button type="submit">送出評論</button>
              </form>
            </div>

                <script>
                  if (!localStorage.getItem('commentsData')) {
                    localStorage.setItem('commentsData', JSON.stringify([]));
                  }
                  let currentRating = 0;
                  function setRating(rating) {
                    currentRating = rating;
                    const stars = document.querySelectorAll('.star-rating .star-icon');
                    stars.forEach((star, index) => {
                      if (index < rating) {
                        star.setAttribute('icon', 'mdi:star');     // 實心星
                        star.classList.add('active');
                      } else {
                        star.setAttribute('icon', 'mdi:star-outline'); // 空心星
                        star.classList.remove('active');
                      }
                    });
                  }
                      
                  function renderComments() {
                    const container = document.getElementById('dynamicComments');
                    const raw = JSON.parse(localStorage.getItem('commentsData') || '[]');
                    const comments = raw.filter(cmt =>
                      cmt &&
                      typeof cmt.name === 'string' && cmt.name.trim() !== '' &&
                      typeof cmt.content === 'string' && cmt.content.trim() !== '' &&
                      typeof cmt.rating === 'number' && cmt.rating >= 1 && cmt.rating <= 5
                    );
                    
                  
                    comments.forEach(cmt => {
                      const date = new Date(cmt.date);
                      const formattedDate = date.toLocaleDateString('zh-TW', {
                        year: 'numeric', month: '2-digit', day: '2-digit',
                        hour: '2-digit', minute: '2-digit'
                      }); 
                      const reviewEl = document.createElement('div');
                      reviewEl.classList.add('review');
                      reviewEl.innerHTML = `
                        <div class="review-header">
                          <span class="review-author">留言者：${cmt.name}</span>
                          <span class="review-date">${formattedDate}</span>
                          <div class="star">
                            ${'★'.repeat(cmt.rating)}${'☆'.repeat(5 - cmt.rating)}
                          </div>
                        </div>
                        <p class="review-text">${cmt.content}</p>
                      `;
                      container.appendChild(reviewEl);
                    });
                  }

                  document.getElementById('comment-form').addEventListener('submit', function(e) {
                    e.preventDefault();
                    const nameInput = document.getElementById('comment-name');
                    const contentInput = document.getElementById('comment-content');
                    const name = nameInput.value.trim();
                    const content = contentInput.value.trim();

                    if (!name || !content || currentRating === 0) {
                      alert('請填寫姓名、評論內容並給予星等');
                      return;
                    }

                    const newComment = {
                      name: name,
                      content: content,
                      rating: currentRating,
                      date: new Date().toISOString()
                    };

                    const comments = JSON.parse(localStorage.getItem('commentsData') || '[]');
                    comments.push(newComment);
                    localStorage.setItem('commentsData', JSON.stringify(comments));
                    nameInput.value = '';
                    contentInput.value = '';
                    setRating(0);

                    renderComments();
                  });
                  window.addEventListener('DOMContentLoaded', () => {
                    renderComments();
                  });

                  function toggleMemberDropdown(event) {
                    event.preventDefault();
                    const drop = document.getElementById('memberDropdown');
                    drop.style.display = drop.style.display === 'block' ? 'none' : 'block';
                  }
                  document.addEventListener('click', function(e) {
                    const drop = document.getElementById('memberDropdown');
                      if (drop && drop.style.display === 'block') {
                        if (!drop.contains(e.target) && !e.target.closest('a[onclick="toggleMemberDropdown(event)"]')) {
                          drop.style.display = 'none';
                        }
                      }
                  });

                  if (!localStorage.getItem('cartData')) {
                    localStorage.setItem('cartData', JSON.stringify([]));
                  }
                  const decreaseBtn = document.getElementById('decreaseQty');
                  const increaseBtn = document.getElementById('increaseQty');
                  const qtyInput = document.getElementById('quantityInput');
                  decreaseBtn.addEventListener('click', () => {
                    let current = parseInt(qtyInput.value, 10);
                    if (isNaN(current) || current < 1) current = 1;
                    if (current > 1) {
                      qtyInput.value = current - 1;
                    }
                  });

                  increaseBtn.addEventListener('click', () => {
                    let current = parseInt(qtyInput.value, 10);
                    if (isNaN(current) || current < 1) current = 1;
                    qtyInput.value = current + 1;
                  });

                  document.getElementById('addToCartBtn').addEventListener('click', () => {
                    const qty = parseInt(qtyInput.value, 10);
                    if (isNaN(qty) || qty < 1) {
                      alert('數量必須至少 1');
                      qtyInput.value = 1;
                      return;
                    }
                    const product = {
                      id: 'item1',
                      title: '愛戀珍珠心（玫瑰金心型珍珠耳環）',
                      price: 280,
                      img: '../assets/image/img/item1.jpg',
                      qty: qty
                    };

                    let cart = JSON.parse(localStorage.getItem('cartData') || '[]');
                    const existingIndex = cart.findIndex(item => item.id === product.id);
                    if (existingIndex > -1) {
                      cart[existingIndex].qty += product.qty;
                    } else {
                      cart.push(product);
                    } 
                    localStorage.setItem('cartData', JSON.stringify(cart));
                    alert(`已將 ${qty} 件「${product.title}」加入購物車！`);
                  });

                  document.getElementById('comment-form').addEventListener('submit', e => {
                    e.preventDefault();
                    const name = document.getElementById('comment-name').value.trim();
                    const content = document.getElementById('comment-content').value.trim();
                    if (!name || !content || currentRating === 0) {
                      alert('請填寫姓名、評論內容並給予星等');
                    return;
                  }
                  alert('感謝您的評論！');
                  document.getElementById('comment-form').reset();
                  setRating(0);
                });
           </script>
</body>
</html>
                      
                    </script>

<footer>
  <h4>桃園市中壢區中北路200號 TEL:0912345678</h4>
  <p><a href="../pages/payment.html">付款方式</a></p>
  <p><a href="../pages/return.html">退貨款政策</a></p>
</footer>


    </article>
    
</body>
</html>
